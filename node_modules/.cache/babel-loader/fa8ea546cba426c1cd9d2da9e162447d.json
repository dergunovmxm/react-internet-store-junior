{"ast":null,"code":"import _objectSpread from\"C:/react/react-internet-store-junior/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/react/react-internet-store-junior/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/react/react-internet-store-junior/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/react/react-internet-store-junior/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/react/react-internet-store-junior/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{Route,Routes}from'react-router-dom';import axios from'axios';import Header from'./components/Header/Header';import Drawer from'./components/Drawer/Drawer';import AppContext from'./context';import{useState,useEffect}from'react';import Home from'./pages/Home';import Favorites from'./pages/Favorites';import Orders from'./pages/Orders';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),items=_useState2[0],setItems=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),cartItems=_useState4[0],setCartItems=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),favorites=_useState6[0],setFavorites=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),searchValue=_useState8[0],setSearchValue=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),cartOpened=_useState10[0],setCartOpened=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),isLoading=_useState12[0],setIsLoading=_useState12[1];useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,cartResponse,favoritesResponse,itemsResponse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([axios.get('https://63440055b9ab4243cadca972.mockapi.io/cart'),axios.get('https://63440055b9ab4243cadca972.mockapi.io/favorite'),axios.get('https://63440055b9ab4243cadca972.mockapi.io/items')]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,3);cartResponse=_yield$Promise$all2[0];favoritesResponse=_yield$Promise$all2[1];itemsResponse=_yield$Promise$all2[2];setIsLoading(false);setCartItems(cartResponse.data);setFavorites(favoritesResponse.data);setItems(itemsResponse.data);_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);alert('Ошибка при запросе данных ;(');console.error(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return _fetchData.apply(this,arguments);}fetchData();},[]);var onAddToCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(obj){var findItem,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;findItem=cartItems.find(function(item){return Number(item.parentId)===Number(obj.id);});if(!findItem){_context2.next=8;break;}setCartItems(function(prev){return prev.filter(function(item){return Number(item.parentId)!==Number(obj.id);});});_context2.next=6;return axios.delete(\"https://63440055b9ab4243cadca972.mockapi.io/cart/\".concat(findItem.id));case 6:_context2.next=14;break;case 8:setCartItems(function(prev){return[].concat(_toConsumableArray(prev),[obj]);});_context2.next=11;return axios.post('https://63440055b9ab4243cadca972.mockapi.io/cart',obj);case 11:_yield$axios$post=_context2.sent;data=_yield$axios$post.data;setCartItems(function(prev){return prev.map(function(item){if(item.parentId===data.parentId){return _objectSpread(_objectSpread({},item),{},{id:data.id});}return item;});});case 14:_context2.next=20;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](0);alert('Ошибка при добавлении в корзину');console.error(_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[0,16]]);}));return function onAddToCart(_x){return _ref.apply(this,arguments);};}();var onRemoveItem=function onRemoveItem(id){try{axios.delete(\"https://63440055b9ab4243cadca972.mockapi.io/cart/\".concat(id));setCartItems(function(prev){return prev.filter(function(item){return Number(item.id)!==Number(id);});});}catch(error){alert('Ошибка при удалении из корзины');console.error(error);}};var onAddToFavorite=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(obj){var _yield$axios$post2,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;if(!favorites.find(function(favObj){return Number(favObj.id)===Number(obj.id);})){_context3.next=6;break;}axios.delete(\"https://63440055b9ab4243cadca972.mockapi.io/favorite/\".concat(obj.id));setFavorites(function(prev){return prev.filter(function(item){return Number(item.id)!==Number(obj.id);});});_context3.next=11;break;case 6:_context3.next=8;return axios.post('https://63440055b9ab4243cadca972.mockapi.io/favorite',obj);case 8:_yield$axios$post2=_context3.sent;data=_yield$axios$post2.data;setFavorites(function(prev){return[].concat(_toConsumableArray(prev),[data]);});case 11:_context3.next=17;break;case 13:_context3.prev=13;_context3.t0=_context3[\"catch\"](0);alert('Не удалось добавить в закладки');console.error(_context3.t0);case 17:case\"end\":return _context3.stop();}}},_callee3,null,[[0,13]]);}));return function onAddToFavorite(_x2){return _ref2.apply(this,arguments);};}();var onChangeSearchInput=function onChangeSearchInput(event){setSearchValue(event.target.value);};var isItemAdded=function isItemAdded(id){return cartItems.some(function(obj){return Number(obj.parentId)===Number(id);});};return/*#__PURE__*/_jsx(AppContext.Provider,{value:{items:items,cartItems:cartItems,favorites:favorites,isItemAdded:isItemAdded,onAddToFavorite:onAddToFavorite,onAddToCart:onAddToCart,setCartOpened:setCartOpened,setCartItems:setCartItems},children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper clear\",children:[/*#__PURE__*/_jsx(Drawer,{items:cartItems,onClose:function onClose(){return setCartOpened(false);},onRemove:onRemoveItem,opened:cartOpened}),/*#__PURE__*/_jsx(Header,{onClickCart:function onClickCart(){return setCartOpened(true);}}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(Home,{items:items,cartItems:cartItems,searchValue:searchValue,setSearchValue:setSearchValue,onChangeSearchInput:onChangeSearchInput,onAddToFavorite:onAddToFavorite,onAddToCart:onAddToCart,isLoading:isLoading})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"favorites\",element:/*#__PURE__*/_jsx(Favorites,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"orders\",element:/*#__PURE__*/_jsx(Orders,{})})]})]})});}export default App;","map":{"version":3,"names":["React","Route","Routes","axios","Header","Drawer","AppContext","useState","useEffect","Home","Favorites","Orders","App","items","setItems","cartItems","setCartItems","favorites","setFavorites","searchValue","setSearchValue","cartOpened","setCartOpened","isLoading","setIsLoading","fetchData","Promise","all","get","cartResponse","favoritesResponse","itemsResponse","data","alert","console","error","onAddToCart","obj","findItem","find","item","Number","parentId","id","prev","filter","delete","post","map","onRemoveItem","onAddToFavorite","favObj","onChangeSearchInput","event","target","value","isItemAdded","some"],"sources":["C:/react/react-internet-store-junior/src/App.js"],"sourcesContent":["import React from 'react';\r\nimport { Route, Routes } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport Header from './components/Header/Header';\r\nimport Drawer from './components/Drawer/Drawer';\r\nimport AppContext from './context';\r\nimport { useState, useEffect } from 'react'\r\n\r\nimport Home from './pages/Home';\r\nimport Favorites from './pages/Favorites';\r\nimport Orders from './pages/Orders';\r\n\r\nfunction App() {\r\n  const [items, setItems] = useState([]);\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [favorites, setFavorites] = useState([]);\r\n  const [searchValue, setSearchValue] = useState('');\r\n  const [cartOpened, setCartOpened] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        const [cartResponse, favoritesResponse, itemsResponse] = await Promise.all([\r\n          axios.get('https://63440055b9ab4243cadca972.mockapi.io/cart'),\r\n          axios.get('https://63440055b9ab4243cadca972.mockapi.io/favorite'),\r\n          axios.get('https://63440055b9ab4243cadca972.mockapi.io/items'),\r\n        ]);\r\n\r\n        setIsLoading(false);\r\n        setCartItems(cartResponse.data);\r\n        setFavorites(favoritesResponse.data);\r\n        setItems(itemsResponse.data);\r\n      } catch (error) {\r\n        alert('Ошибка при запросе данных ;(');\r\n        console.error(error);\r\n      }\r\n    }\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const onAddToCart = async (obj) => {\r\n    try {\r\n      const findItem = cartItems.find((item) => Number(item.parentId) === Number(obj.id));\r\n      if (findItem) {\r\n        setCartItems((prev) => prev.filter((item) => Number(item.parentId) !== Number(obj.id)));\r\n        await axios.delete(`https://63440055b9ab4243cadca972.mockapi.io/cart/${findItem.id}`);\r\n      } else {\r\n        setCartItems((prev) => [...prev, obj]);\r\n        const { data } = await axios.post('https://63440055b9ab4243cadca972.mockapi.io/cart', obj);\r\n        setCartItems((prev) =>\r\n          prev.map((item) => {\r\n            if (item.parentId === data.parentId) {\r\n              return {\r\n                ...item,\r\n                id: data.id,\r\n              };\r\n            }\r\n            return item;\r\n          }),\r\n        );\r\n      }\r\n    } catch (error) {\r\n      alert('Ошибка при добавлении в корзину');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const onRemoveItem = (id) => {\r\n    try {\r\n      axios.delete(`https://63440055b9ab4243cadca972.mockapi.io/cart/${id}`);\r\n      setCartItems((prev) => prev.filter((item) => Number(item.id) !== Number(id)));\r\n    } catch (error) {\r\n      alert('Ошибка при удалении из корзины');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const onAddToFavorite = async (obj) => {\r\n    try {\r\n      if (favorites.find((favObj) => Number(favObj.id) === Number(obj.id))) {\r\n        axios.delete(`https://63440055b9ab4243cadca972.mockapi.io/favorite/${obj.id}`);\r\n        setFavorites((prev) => prev.filter((item) => Number(item.id) !== Number(obj.id)));\r\n      } else {\r\n        const { data } = await axios.post(\r\n          'https://63440055b9ab4243cadca972.mockapi.io/favorite',\r\n          obj,\r\n        );\r\n        setFavorites((prev) => [...prev, data]);\r\n      }\r\n    } catch (error) {\r\n      alert('Не удалось добавить в закладки');\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const onChangeSearchInput = (event) => {\r\n    setSearchValue(event.target.value);\r\n  };\r\n\r\n  const isItemAdded = (id) => {\r\n    return cartItems.some((obj) => Number(obj.parentId) === Number(id));\r\n  };\r\n\r\n  return (\r\n    <AppContext.Provider\r\n      value={{\r\n        items,\r\n        cartItems,\r\n        favorites,\r\n        isItemAdded,\r\n        onAddToFavorite,\r\n        onAddToCart,\r\n        setCartOpened,\r\n        setCartItems,\r\n      }}>\r\n      <div className=\"wrapper clear\">\r\n        <Drawer\r\n          items={cartItems}\r\n          onClose={() => setCartOpened(false)}\r\n          onRemove={onRemoveItem}\r\n          opened={cartOpened}\r\n        />\r\n\r\n        <Header onClickCart={() => setCartOpened(true)} />\r\n\r\n        <Routes>\r\n          <Route exact path=\"/\" element={\r\n            <Home\r\n              items={items}\r\n              cartItems={cartItems}\r\n              searchValue={searchValue}\r\n              setSearchValue={setSearchValue}\r\n              onChangeSearchInput={onChangeSearchInput}\r\n              onAddToFavorite={onAddToFavorite}\r\n              onAddToCart={onAddToCart}\r\n              isLoading={isLoading}\r\n            />} />\r\n\r\n          <Route exact path=\"favorites\"\r\n            element={<Favorites />}\r\n          />\r\n          <Route exact path=\"orders\"\r\n            element={\r\n              <Orders />\r\n            } />\r\n        </Routes>\r\n      </div>\r\n    </AppContext.Provider >\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}